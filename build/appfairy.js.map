{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///external \"cheerio\"","webpack:///external \"path\"","webpack:///./src/git.js","webpack:///external \"execa\"","webpack:///./src/libs/index.js","webpack:///./src/libs/fs.js","webpack:///external \"fs\"","webpack:///external \"util\"","webpack:///./src/libs/mkdirp.js","webpack:///external \"fs-extra\"","webpack:///./src/libs/ncp.js","webpack:///./src/libs/reread.js","webpack:///external \"recursive-readdir\"","webpack:///./src/libs/rimraf.js","webpack:///./src/utils/index.js","webpack:///./src/utils/internal.js","webpack:///./src/utils/requireText.js","webpack:///external \"resolve\"","webpack:///./src/writers/index.js","webpack:///./src/writers/writer.js","webpack:///./src/writers/view-writer.js","webpack:///external \"htmltojsx\"","webpack:///external \"statuses\"","webpack:///external \"uglify-js\"","webpack:///./src/static/server/index.js","webpack:///./src/static/server/loader.js","webpack:///./src/static/server/server.js","webpack:///./src/raw/index.js","webpack:///./src/writers/script-writer.js","webpack:///external \"node-fetch\"","webpack:///./src/writers/style-writer.js","webpack:///external \"clean-css\""],"names":["defaultPublicSubFolders","transpile","config","inputFiles","outputFiles","Promise","all","fs","readdir","input","then","files","git","removeAppfairyFiles","push","e","console","log","folders","filter","path","extname","file","length","includes","map","folder","htmlFiles","publicSubDirs","scriptWriter","ScriptWriter","baseUrl","prefetch","styleWriter","StyleWriter","source","srouce","transpilingHTMLFiles","transpileHTMLFile","htmlFile","viewWriters","writingFiles","ViewWriter","writeAll","output","src","views","components","meta","styles","controllers","paths","write","makingPublicDir","makePublicDir","add","commit","html","readFile","toString","$","cheerio","load","$head","$body","viewWriter","name","split","slice","join","parent","setStyles","setHTML","publicDir","public","ncp","publicSubDir","filePaths","reread","relativePaths","relativePath","relative","filePath","css","encapsulateCSS","writeFile","_","stylesDir","$styles","find","each","i","style","$style","setStyle","attr","$div","stdout","root","execa","resolve","unstaged","results","reduce","concat","Boolean","message","stdio","diffFiles","Error","stderr","hash","unlink","mkdir","promisify","stat","mkdirp","copy","remove","escape","str","quote","replace","match","left","rule","right","test","trim","freeText","text","Array","baseIndent","content","line","lines","minIndent","currIndent","Infinity","freeLint","script","freeContext","freeScope","context","args","callArgs","Object","keys","upperFirst","substr","toUpperCase","splitWords","word","padLeft","char","String","parseInt","Internal","TypeError","Klass","internals","defineProperty","prototype","get","_this","forEach","key","value","bind","getOwnPropertyNames","getOwnPropertyDescriptor","publicKey","cache","requireText","resolvePath","sync","readFileSync","promise","reject","err","Writer","Symbol","htmltojsx","HTMLtoJSX","createClass","flattenChildren","children","flatten","child","removeHtmlFromLinks","dir","componentDir","metaDir","ctrlsDir","serverPromises","ServerIndex","ServerServer","ServerLoader","indexFilePath","helpersFilePath","routesFilePath","childFilePaths","routes","className","toLowerCase","index","writtingRoutes","writingIndex","writingHelpers","raw","viewHelpers","isNaN","Number","statuses","words","assign","ctrlClassName","metaClassName","elName","el","$el","$afEl","insertAfter","scripts","$script","type","body","$afContainer","append","contents","prepend","sockets","socketName","tagName","jsx","convert","bindJSX","constructor","options","writingChildren","isNestedComponent","writingSelf","compose","href","exists","some","sheets","sheet","_compose","compDir","shouldHaveStyles","composeChildImports","composeProxiesDefault","_composeStyleImports","_composeProxiesDefault","socket","_composeChildImports","imports","_composeScriptsDeclerations","minified","uglify","minify","code","_composeScriptsInvocations","invoke","RegExp","sock","attrs","mergeProps","filename","__dirname","composeScriptLoader","scriptFileNames","fileName","fetchingScripts","scriptFileName","fetch","res","scriptsIndexContent","setScript","_composeScriptLoader","cleanCSS","CleanCSS","rebaseTo","composeStyleLoader","styleFileNames","fetchingStyles","styleFileName","transformSheet","stylesIndexContent","_composeStyleLoader","composeSourceReplacements","_composeSourceReplacements","_transformSheet","url"],"mappings":"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","file":"appfairy.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","import cheerio from \"cheerio\";\nimport path from \"path\";\nimport git from \"./git\";\nimport { fs, ncp, reread } from \"./libs\";\nimport { encapsulateCSS } from \"./utils\";\nimport { ViewWriter, ScriptWriter, StyleWriter } from \"./writers\";\n\nconst defaultPublicSubFolders = [\"css\", \"fonts\", \"images\", \"js\"];\n\nexport const transpile = async config => {\n  let inputFiles;\n  let outputFiles = [];\n  try {\n    await Promise.all([\n      fs.readdir(config.input).then(files => {\n        inputFiles = files;\n      }),\n      git.removeAppfairyFiles().then(files => {\n        outputFiles.push(...files);\n      })\n    ]);\n  } catch (e) {\n    console.log(e);\n  }\n\n  const folders = inputFiles.filter(\n    file =>\n      !path.extname(file).length && !defaultPublicSubFolders.includes(file)\n  );\n  try {\n    await Promise.all(\n      folders.map(folder =>\n        fs.readdir(`${config.input}/${folder}`).then(files => {\n          inputFiles = [\n            ...(inputFiles || []),\n            ...(files || []).map(file => `${folder}/${file}`)\n          ];\n        })\n      )\n    );\n  } catch (e) {\n    console.log(e);\n  }\n  const htmlFiles = inputFiles.filter(file => path.extname(file) == \".html\");\n\n  const publicSubDirs = inputFiles.filter(\n    file => !path.extname(file) && defaultPublicSubFolders.includes(file)\n  );\n\n  const scriptWriter = new ScriptWriter({\n    baseUrl: config.input,\n    prefetch: config.prefetch\n  });\n\n  const styleWriter = new StyleWriter({\n    baseUrl: config.input,\n    prefetch: config.prefetch,\n    source: config.srouce\n  });\n\n  const transpilingHTMLFiles = htmlFiles.map(htmlFile => {\n    return transpileHTMLFile(config, htmlFile, scriptWriter, styleWriter);\n  });\n  const viewWriters = await Promise.all(transpilingHTMLFiles);\n  const writingFiles = Promise.all([\n    ViewWriter.writeAll(\n      viewWriters,\n      config.output.src.views,\n      config.output.src.components,\n      config.output.src.meta,\n      config.output.src.styles,\n      config.output.src.controllers\n    ).then(paths => outputFiles.push(...paths)),\n    // scriptWriter.write(\n    //   config.output.src.scripts\n    // ).then((paths) => outputFiles.push(...paths)),\n    styleWriter\n      .write(config.output.src.styles)\n      .then(paths => outputFiles.push(...paths))\n  ]);\n\n  const makingPublicDir = makePublicDir(config, publicSubDirs).then(paths =>\n    outputFiles.push(...paths)\n  );\n  try {\n    await Promise.all([writingFiles, makingPublicDir]);\n  } catch (e) {\n    console.log(e);\n  }\n\n  return git.add(outputFiles).then(files => {\n    return git.commit(files, \"Update design\");\n  });\n};\n\nconst transpileHTMLFile = async (\n  config,\n  htmlFile,\n  scriptWriter,\n  styleWriter\n) => {\n  const html = (await fs.readFile(`${config.input}/${htmlFile}`)).toString();\n  const $ = cheerio.load(html);\n  const $head = $(\"head\");\n  if (!!scriptWriter && !!styleWriter) {\n    // pass\n  }\n  const $body = $(\"body\");\n  const viewWriter = new ViewWriter({\n    name: htmlFile\n      .split('/')[htmlFile.split('/').length-1]\n      .split(\".\")\n      .slice(0, -1)\n      .join(\".\"),\n    baseUrl: config.baseUrl,\n    parent: htmlFile.split('/')[0] === htmlFile ? null : htmlFile.split('/')[0],\n    source: config.source\n  });\n\n\n  // setScripts(scriptWriter, $head, $)\n\n  setStyles(viewWriter, styleWriter, $head, $, config.output.src.styles);\n  setHTML(viewWriter, $body, $);\n\n  return viewWriter;\n};\n\nconst makePublicDir = async (config, publicSubDirs) => {\n  const publicDir = config.output.public;\n  await Promise.all(\n    publicSubDirs.map(publicSubDir => {\n      return ncp(\n        `${config.input}/${publicSubDir}`,\n        `${publicDir}/${publicSubDir}`\n      );\n    })\n  );\n\n  // Resolving relative paths\n  const filePaths = await reread(config.input);\n\n  const relativePaths = filePaths.map(filePath => {\n    const relativePath = path.relative(config.input, filePath);\n\n    return `${publicDir}/${relativePath}`;\n  });\n\n  // Encapsulate CSS files\n  await Promise.all(\n    relativePaths.map(async relativePath => {\n      if (path.extname(relativePath) != \".css\") return;\n\n      let css = (await fs.readFile(relativePath)).toString();\n      css = encapsulateCSS(css, config.source);\n      await fs.writeFile(relativePath, css);\n    })\n  );\n\n  return relativePaths;\n};\n\n// const setScripts = (scriptWriter, $head) => {\n//   const $scripts = $head.find('script[type=\"text/javascript\"]')\n\n//   $scripts.each((i, script) => {\n//     const $script = $head.find(script)\n\n//     scriptWriter.setScript($script.attr('src'), $script.html())\n//   })\n// }\n\nconst setStyles = (viewWriter, styleWriter, $head, _, stylesDir) => {\n  let $styles;\n\n  $styles = $head.find('link[rel=\"stylesheet\"][type=\"text/css\"]');\n\n  $styles.each((i, style) => {\n    const $style = $head.find(style);\n\n    viewWriter.setStyle($style.attr(\"href\"), $style.html(), stylesDir);\n    styleWriter.setStyle($style.attr(\"href\"), $style.html());\n  });\n\n  $styles = $head.find(\"style\");\n\n  $styles.each((i, style) => {\n    const $style = $head.find(style);\n\n    viewWriter.setStyle($style.attr(\"href\"), $style.html(), stylesDir);\n    styleWriter.setStyle($style.attr(\"href\"), $style.html());\n  });\n};\n\nconst setHTML = (viewWriter, $body, $) => {\n  // Create a wrap around $body so we can inherit its style without actually\n  // using a <body> tag\n  const $div = $(\"<div>\");\n  $div.html($body.html());\n  $div.attr($body.attr());\n  viewWriter.html = $.html($div);\n};\n","module.exports = require(\"cheerio\");","module.exports = require(\"path\");","import execa from 'execa'\nimport path from 'path'\nimport { fs } from './libs'\n\n// Will add given files and will ignore those who aren't exist\nexport const add = async (files) => {\n  const { stdout: root } = await execa('git', [\n    'rev-parse', '--show-toplevel'\n  ])\n\n  files = files.map((file) => path.resolve(root, file))\n\n  let unstaged = await Promise.all([\n    execa('git', ['diff', '--name-only']),\n    execa('git', ['ls-files', '--others', '--exclude-standard']),\n  ]).then((results) => {\n    return results.reduce((unstaged, { stdout }) => {\n      return unstaged.concat(stdout.split('\\n').filter(Boolean))\n    }, [])\n  })\n\n  unstaged = unstaged.map((file) => path.resolve(root, file))\n  files = files.filter((file) => unstaged.includes(file))\n\n  await execa('git', ['add', ...files])\n\n  return files\n}\n\n// Will commit changes, and if files not exist, will print status\nexport const commit = (files, message, stdio = 'inherit') => {\n  if (files && files.length) try {\n    return execa('git', ['commit', '-m', `update: ${message}`], {\n      stdio,\n    })\n  }\n  catch (e) {\n    // Probably no changes were made\n  }\n\n  return execa('git', ['status'], {\n    stdio,\n  })\n}\n\nexport const removeAppfairyFiles = async () => {\n  const { stdout: diffFiles } = await execa('git', [\n    'diff', '--name-only'\n  ])\n\n  if (diffFiles) {\n    throw Error([\n      'Cannot transpile: Your index contains uncommitted changes.',\n      'Please commit or stash them.',\n    ].join('\\n'))\n  }\n\n  let { stderr, stdout: hash } = await execa('git', [\n    'log', '-1', '--format=%H', `--grep=appfairy: Update design`\n  ])\n\n  // Probably git is not initialized\n  if (stderr) throw Error(stderr)\n  // No previous migrations found\n  if (!hash) return []\n\n  // List all files but deleted ones\n  let { stdout: files } = await execa('git', [\n    'diff', '--name-only', '--diff-filter=ACMRTUXB', `${hash}~1`, hash\n  ])\n  files = files.split('\\n').filter(Boolean)\n\n  const { stdout: root } = await execa('git', [\n    'rev-parse', '--show-toplevel'\n  ])\n\n  await Promise.all(files.map(async (file) => {\n    return fs.unlink(`${root}/${file}`)\n  }))\n\n  return files\n}\n\nexport default {\n  add,\n  commit,\n  removeAppfairyFiles,\n}\n","module.exports = require(\"execa\");","export { default as fs } from './fs'\nexport { default as mkdirp } from './mkdirp'\nexport { default as ncp } from './ncp'\nexport { default as reread } from './reread'\nexport { default as rimraf } from './rimraf'\n","import fs from 'fs'\nimport { promisify } from 'util'\n\nexport const mkdir = promisify(fs.mkdir)\nexport const readdir = promisify(fs.readdir)\nexport const readFile = promisify(fs.readFile)\nexport const stat = promisify(fs.stat)\nexport const unlink = promisify(fs.unlink)\nexport const writeFile = promisify(fs.writeFile)\n\nexport default {\n  mkdir,\n  readdir,\n  readFile,\n  stat,\n  unlink,\n  writeFile,\n}\n","module.exports = require(\"fs\");","module.exports = require(\"util\");","import fs from 'fs-extra'\nimport { promisify } from 'util'\n\nexport default promisify(fs.mkdirp)\n","module.exports = require(\"fs-extra\");","import fs from 'fs-extra'\nimport { promisify } from 'util'\n\nexport default promisify(fs.copy)\n","import reread from 'recursive-readdir'\nimport { promisify } from 'util'\n\nexport default promisify(reread)\n","module.exports = require(\"recursive-readdir\");","import fs from 'fs-extra'\nimport { promisify } from 'util'\n\nexport default promisify(fs.remove)\n","export { default as Internal } from './internal'\nexport { default as requireText } from './requireText'\n\n// Useful for nested strings that should be evaluated\nexport const escape = (str, quote) => {\n  str = str.replace(/\\\\/g, '\\\\\\\\')\n\n  switch (quote) {\n    case \"'\": return str.replace(/'/g, \"\\\\'\")\n    case '\"': return str.replace(/\"/g, '\\\\\"')\n    case '`': return str.replace(/`/g, '\\\\`')\n    default: return str\n      .replace(/'/g, \"\\\\'\")\n      .replace(/\"/g, '\\\\\"')\n      .replace(/`/g, '\\\\`')\n  }\n}\n\n// Encapsulates all rules under .af-view\nexport const encapsulateCSS = (css, source) => {\n  return css.replace(\n    /((?:^|\\{|\\}|;)\\s*(?:\\/\\*[^]*?\\*\\/\\s*)*)([^@{}]+?)(\\s*\\{)/g, (\n    match, left, rule, right\n  ) => {\n    // Animation keyframe e.g. 50%\n    if (/^\\d/.test(rule)) return match\n    // Empty line skip, probably after a media query or so\n    if (!rule.trim()) return match\n\n    // Apply for all selectors in rule\n    // Note that <html /> and <body /> tags are replaced with .af-view\n    rule = rule\n      .replace(/\\.([\\w_-]+)/g, '.af-class-$1')\n      .replace(/\\[class(.?)=\"( ?)([^\"]+)( ?)\"\\]/g, '[class$1=\"$2af-class-$3$4\"]')\n      .replace(/([^\\s][^,]*)(\\s*,?)/g, '.af-view $1$2')\n      .replace(/\\.af-view html/g, '.af-view')\n      .replace(/\\.af-view body/g, '.af-view')\n\n    switch (source) {\n      case 'webflow':\n        rule = rule\n          .replace(/af-class-w-/g, 'w-')\n        break\n      case 'sketch':\n        rule = rule\n          .replace(/af-class-anima-/g, 'anima-')\n          .replace(/af-class-([\\w_-]+)an-animation([\\w_-]+)/g, '$1an-animation$2')\n        break\n      default:\n        rule = rule\n          .replace(/af-class-w-/g, 'w-')\n          .replace(/af-class-anima-/g, 'anima-')\n          .replace(/af-class-([\\w_-]+)an-animation([\\w_-]+)/g, '$1an-animation$2')\n    }\n\n    return `${left}${rule}${right}`\n  })\n}\n\n// Will use the shortest indention as an axis\nexport const freeText = (text) => {\n  if (text instanceof Array) {\n    text = text.join('')\n  }\n\n  // This will allow inline text generation with external functions, same as ctrl+shift+c\n  // As long as we surround the inline text with ==>text<==\n  text = text.replace(\n    /( *)==>((?:.|\\n)*?)<==/g,\n    (match, baseIndent, content) =>\n  {\n    return content\n      .split('\\n')\n      .map(line => `${baseIndent}${line}`)\n      .join('\\n')\n  })\n\n  const lines = text.split('\\n')\n\n  const minIndent = lines.filter(line => line.trim()).reduce((minIndent, line) => {\n    const currIndent = line.match(/^ */)[0].length\n\n    return currIndent < minIndent ? currIndent : minIndent\n  }, Infinity)\n\n  return lines\n    .map(line => line.slice(minIndent))\n    .join('\\n')\n    .trim()\n    .replace(/\\n +\\n/g, '\\n\\n')\n}\n\n// Calls freeText() and disables lint\nexport const freeLint = (script) => {\n  return freeText(`\n    /* eslint-disable */\n\n    ==>${freeText(script)}<==\n\n    /* eslint-enable */\n  `)\n}\n\n// Calls freeLint() and ensures that 'this' is represented by window\nexport const freeContext = (script) => {\n  return freeLint(`\n    (function() {\n\n    ==>${freeText(script)}<==\n\n    }).call(window)\n  `)\n}\n\n// Creates a completely isolated scope with Function constructor.\n// args is a varToInject-injectedVarName map.\nexport const freeScope = (script, context = 'window', args = {}) => {\n  const callArgs = [context].concat(Object.keys(args))\n\n  return freeText(`\n    new Function(\\`\n      with (this) {\n        ${script}\n      }\n    \\`).call(${callArgs.join(', ')})\n  `)\n}\n\n// upper -> Upper\nexport const upperFirst = (str) => {\n  return str.substr(0, 1).toUpperCase() + str.substr(1)\n}\n\n// foo_barBaz -> ['foo', 'bar', 'Baz']\nexport const splitWords = (str) => {\n  return str\n    .replace(/[A-Z]/, ' $&')\n    .split(/[^a-zA-Z0-9]+/)\n    .filter(word => word.trim())\n}\n\n// abc 5 0 -> 00abc\nexport const padLeft = (str, length, char = ' ') => {\n  str = String(str)\n  length = parseInt(length + 1 - str.length)\n\n  return Array(length).join(char) + str\n}\n","const Internal = (_) => {\n  if (typeof _ != 'symbol') {\n    throw TypeError('Accessor must me a symbol')\n  }\n\n  return (Klass) => {\n    if (typeof Klass != 'function') {\n      throw TypeError('Provided target is not a class')\n    }\n\n    const internals = {}\n\n    Object.defineProperty(Klass.prototype, _, {\n      get() {\n        const _this = { ...internals }\n\n        Object.keys(_this).forEach((key) => {\n          const value = _this[key]\n\n          if (typeof value == 'function') {\n            _this[key] = value.bind(this)\n          }\n        })\n\n        Object.defineProperty(this, _, {\n          value: _this\n        })\n\n        return _this\n      }\n    })\n\n    Object.getOwnPropertyNames(Klass.prototype).forEach((key) => {\n      if (key[0] != '_') return\n\n      const { value } = Object.getOwnPropertyDescriptor(Klass.prototype, key)\n\n      if (typeof value != 'function') return\n\n      const publicKey = key.slice(1)\n      internals[publicKey] = value\n      delete Klass.prototype[key]\n    })\n  }\n}\n\nexport default Internal\n","import { readFile, readFileSync } from 'fs'\nimport resolvePath from 'resolve'\n\nconst cache = {}\n\nconst requireText = (path) => {\n  path = resolvePath.sync(path)\n\n  return cache[path] = cache[path] || readFileSync(path).toString()\n}\n\nrequireText.promise = (path) => new Promise((resolve, reject) => {\n  resolvePath(path, (err, path) => {\n    if (err) {\n      return reject(err)\n    }\n\n    let content = cache[path]\n\n    if (content) {\n      return resolve(content)\n    }\n\n    readFile(path, (err, content) => {\n      if (err) {\n        return reject(err)\n      }\n\n      cache[path] = content = content.toString()\n\n      resolve(content)\n    })\n  })\n})\n\nexport default requireText\n","module.exports = require(\"resolve\");","export { default as Writer } from './writer'\nexport { default as ViewWriter } from './view-writer'\nexport { default as ScriptWriter } from './script-writer'\nexport { default as StyleWriter } from './style-writer'\n","class Writer {\n  write() {\n    throw Error('Writer.write() must be implemented')\n  }\n}\n\nexport default Writer\n","import cheerio from \"cheerio\";\nimport HTMLtoJSX from \"htmltojsx\";\nimport path from \"path\";\nimport statuses from \"statuses\";\nimport uglify from \"uglify-js\";\nimport ServerIndex from '../static/server';\nimport ServerLoader from '../static/server/loader';\nimport ServerServer from '../static/server/server';\nimport { fs, mkdirp } from \"../libs\";\nimport raw from \"../raw\";\nimport Writer from \"./writer\";\n\nimport {\n  encapsulateCSS,\n  escape,\n  freeLint,\n  freeScope,\n  freeText,\n  Internal,\n  splitWords,\n  upperFirst\n} from \"../utils\";\n\nconst _ = Symbol(\"_ViewWriter\");\nconst htmltojsx = new HTMLtoJSX({ createClass: false });\n\nconst flattenChildren = (children = [], flatten = []) => {\n  children.forEach(child => {\n    flattenChildren(child[_].children, flatten);\n  });\n\n  flatten.push(...children);\n\n  return flatten;\n};\n\nconst removeHtmlFromLinks = (html) => html.replace('index.html', '').replace(/\\.html/ig, '')\n\n@Internal(_)\nclass ViewWriter extends Writer {\n  static async writeAll(viewWriters, dir, componentDir, metaDir, stylesDir, ctrlsDir) {\n    await mkdirp(dir);\n    await mkdirp(componentDir);\n    await mkdirp(stylesDir);\n    await mkdirp(metaDir);\n    await mkdirp(`${dir}/../../server`);\n\n    const serverPromises = [\n      fs.writeFile(`${dir}/../../server/index.js`, freeLint(ServerIndex)),\n      fs.writeFile(`${dir}/../../server/server.js`, freeLint(ServerServer)),\n      fs.writeFile(`${dir}/../../server/loader.js`, freeLint(ServerLoader))\n    ]\n\n    await Promise.all(serverPromises);\n\n\n    const indexFilePath = `${dir}/index.js`;\n    const helpersFilePath = `${dir}/../helpers.js`;\n    const routesFilePath = `${dir}/../routes.js`;\n    const childFilePaths = [indexFilePath, helpersFilePath, routesFilePath];\n    ctrlsDir = path.relative(dir, ctrlsDir);\n    const routes = `\nimport React from 'react';\nimport { Route } from 'react-router-dom';\nimport * as Views from './views';\n\nexport default () => [\n  <Route path=\"/\" component={Views.IndexView} exact />,\n  ${viewWriters\n    .map(\n      viewWriter => `<Route path=\"${viewWriter.parent ? `/${viewWriter.parent}` : ''}/${viewWriter.className.replace(/view/gi, '').split(/(?=[A-Z])/).join('-').toLowerCase()}\" component={Views.${viewWriter.className}} exact />`\n    )\n    .join(\",\\n  \")}\n]`;\n\n    const index = viewWriters\n      .map(viewWriter => {\n        return `export { default as ${viewWriter.className} } from './${\n          viewWriter.className\n        }'`;\n      })\n      .join(\"\\n\");\n\n\n    viewWriters = flattenChildren(viewWriters);\n\n    for(const viewWriter of viewWriters) {\n      const filePaths = await viewWriter.write(dir, componentDir, metaDir, stylesDir, ctrlsDir);\n      childFilePaths.push(...filePaths);\n    }\n\n\n    const writtingRoutes = fs.writeFile(routesFilePath, freeLint(routes));\n    const writingIndex = fs.writeFile(indexFilePath, freeLint(index));\n    const writingHelpers = fs.writeFile(helpersFilePath, raw.viewHelpers);\n\n    await Promise.all([writingIndex, writingHelpers, writtingRoutes]);\n    return childFilePaths;\n  }\n\n  get baseUrl() {\n    return this[_].baseUrl;\n  }\n\n  set baseUrl(baseUrl) {\n    this[_].baseUrl = String(baseUrl);\n  }\n\n  get children() {\n    return this[_].children.slice();\n  }\n\n  set name(name) {\n    if (!isNaN(Number(name))) {\n      name = statuses[name];\n    }\n\n    const words = splitWords(name);\n    Object.assign(this[_], {\n      ctrlClassName: words\n        .concat(\"controller\")\n        .map(upperFirst)\n        .join(\"\"),\n      metaClassName: words\n        .concat(\"meta\")\n        .map(upperFirst)\n        .join(\"\"),\n      className: words\n        .concat(\"view\")\n        .map(upperFirst)\n        .join(\"\"),\n      elName: words.map(word => word.toLowerCase()).join(\"-\"),\n      name: words\n        .concat(\"view\")\n        .map(word => word.toLowerCase())\n        .join(\"-\")\n    });\n  }\n\n  get name() {\n    return this[_].name;\n  }\n\n  get ctrlClassName() {\n    return this[_].ctrlClassName;\n  }\n\n  get metaClassName() {\n    return this[_].metaClassName;\n  }\n\n  get className() {\n    return this[_].className;\n  }\n\n  get elName() {\n    return this[_].elName;\n  }\n\n  set html(html) {\n    if (!html) {\n      this[_].html = \"\";\n      this[_].children = [];\n      return;\n    }\n\n    const children = (this[_].children = []);\n    const $ = cheerio.load(html);\n\n    // Encapsulate styles\n    $(\"style\").each((i, el) => {\n      const $el = $(el);\n      const html = $el.html();\n      const css = encapsulateCSS(html, this.source);\n\n      $el.html(css);\n    });\n\n    $(\"*\").each((i, el) => {\n      const $el = $(el);\n      let className = $el.attr(\"class\");\n\n      if (className && !/af-class-/.test(className)) {\n        className = className.replace(/([\\w_-]+)/g, \"af-class-$1\");\n\n        switch (this.source) {\n          case \"webflow\":\n            className = className.replace(/af-class-w-/g, \"w-\");\n            break;\n          case \"sketch\":\n            className = className\n              .replace(/af-class-anima-/g, \"anima-\")\n              .replace(\n                /af-class-([\\w_-]+)an-animation([\\w_-]+)/g,\n                \"$1an-animation$2\"\n              );\n            break;\n          default:\n            className = className\n              .replace(/af-class-w-/g, \"w-\")\n              .replace(/af-class-anima-/g, \"anima-\")\n              .replace(\n                /af-class-([\\w_-]+)an-animation([\\w_-]+)/g,\n                \"$1an-animation$2\"\n              );\n        }\n\n        $el.attr(\"class\", className);\n      }\n    });\n\n    let el = $(\"[af-el]\")[0];\n    while (el) {\n      const $el = $(el);\n      const elName = $el.attr(\"af-el\");\n      const $afEl = $(`<af-${elName}></af-${elName}>`);\n\n      $afEl.attr(\"af-sock\", $el.attr(\"af-sock\"));\n      $el.attr(\"af-el\", null);\n      $el.attr(\"af-sock\", null);\n      $afEl.insertAfter($el);\n      $el.remove();\n\n      const child = new ViewWriter({\n        name: elName,\n        html: $.html($el),\n        baseUrl: this.baseUrl,\n        styles: this.styles\n      });\n\n      children.push(child);\n      el = $(\"[af-el]\")[0];\n    }\n\n    // Apply ignore rules AFTER child elements were plucked\n    $(\"[af-ignore]\").remove();\n    // Empty inner HTML\n    $(\"[af-empty]\")\n      .html(\"\")\n      .attr(\"af-empty\", null);\n\n    this[_].scripts = [];\n\n    // Set inline scripts. Will be loaded once component has been mounted\n    $(\"script\").each((i, script) => {\n      const $script = $(script);\n      const src = $script.attr(\"src\");\n      const type = $script.attr(\"type\");\n\n      // We're only interested in JavaScript script tags\n      if (type && !/javascript/i.test(type)) return;\n\n      if (src) {\n        this[_].scripts.push({\n          type: \"src\",\n          body: src\n        });\n      } else {\n        this[_].scripts.push({\n          type: \"code\",\n          body: $script.html()\n        });\n      }\n\n      $script.remove();\n    });\n\n    // Wrapping with .af-view will apply encapsulated CSS\n    const $body = $(\"body\");\n    const $afContainer = $('<span class=\"af-view\"></span>');\n\n    $afContainer.append($body.contents());\n    $afContainer.prepend(\"\\n  \");\n    $afContainer.append(\"\\n  \");\n    $body.append($afContainer);\n\n    html = $body.html();\n\n    this[_].html = html;\n\n    const sockets = (this[_].sockets = []);\n\n    // Find root sockets\n    $(\"[af-sock]\").each((i, el) => {\n      const $el = $(el);\n      const socketName = $el.attr(\"af-sock\");\n      sockets.push(socketName);\n\n      $el.attr(\"af-sock\", null);\n      // Workaround would help identify the closing tag\n      el.tagName += `-af-sock-${socketName}`;\n    });\n\n    // Refetch modified html\n    html = $body.html();\n\n\n\n    // Transforming HTML into JSX\n    let jsx = htmltojsx.convert(removeHtmlFromLinks(html)).trim();\n    // Bind controller to view\n    this[_].jsx = bindJSX(jsx, children);\n  }\n\n  get scripts() {\n    return this[_].scripts ? this[_].scripts.slice() : [];\n  }\n\n  get styles() {\n    return this[_].styles.slice();\n  }\n\n  get html() {\n    return this[_].html;\n  }\n\n  get jsx() {\n    return this[_].jsx;\n  }\n\n  get sockets() {\n    return this[_].sockets && [...this[_].sockets];\n  }\n\n  get source() {\n    return this[_].source;\n  }\n\n  set source(source) {\n    this[_].source = String(source);\n  }\n\n  constructor(options) {\n    super();\n\n    this[_].children = [];\n    this[_].styles = options.styles || [];\n\n    this.name = options.name;\n    this.parent = options.parent;\n    this.html = options.html;\n    this.source = options.source;\n  }\n\n  async write(dir, componentDir, metaDir, stylesDir, ctrlsDir) {\n    const filePath = `${dir}/${this.className}.js`;\n    const childFilePaths = [filePath];\n    const writingChildren = this[_].children.map(async child => {\n      const filePaths = await child.write(componentDir, componentDir, metaDir, stylesDir, ctrlsDir);\n      childFilePaths.push(...filePaths);\n    });\n    const isNestedComponent = dir === componentDir;\n    let writingSelf\n    try {\n      await fs.readFile(`${dir}/${this.className}.js`);\n    } catch(e) {\n      // pass\n      writingSelf = fs.writeFile(\n        `${dir}/${this.className}.js`,\n        this[_].compose(\n          path.relative(dir, componentDir),\n          path.relative(dir, metaDir),\n          path.relative(dir, stylesDir),\n          ctrlsDir,\n          !isNestedComponent\n        )\n      )\n    }\n\n\n    try {\n      await Promise.all([...writingChildren, writingSelf]);\n    } catch(e) {\n      console.log(e);\n    }\n    return childFilePaths;\n  }\n\n  async setStyle(href, content, stylesDir) {\n    let type;\n    let body;\n\n    if (href) {\n      type = \"href\";\n      body = /^\\w+:\\/\\//.test(href) ? href : path.resolve(\"/\", href);\n    } else {\n      type = \"sheet\";\n      body = content;\n    }\n\n    const exists = this[_].styles.some(style => {\n      return style.body == body;\n    });\n\n    if (!exists) {\n      this[_].styles.push({ type, body });\n    }\n\n    const sheets = this[_].styles\n      .map(({ type, body }) => {\n        return type == \"sheet\" && body;\n      })\n      .filter(Boolean);\n\n    let css = \"\";\n\n    // css += hrefs.map((href) => {\n    //   return `@import url(${href});`\n    // }).join('\\n')\n\n\n    css += \"\\n\\n\";\n\n    css += sheets\n      .map(sheet => {\n        return sheet;\n      })\n      .join(\"\\n\\n\");\n    if(!stylesDir || !css.length) return true;\n    try {\n      await mkdirp(stylesDir);\n      await fs.writeFile(`${stylesDir}/${this.className}.css` , escape(css.trim()));\n    } catch(e) {\n      console.log(e);\n    }\n  }\n\n  _compose(compDir, metaDir, stylesDir, ctrlsDir, shouldHaveStyles = true) {\n    return freeLint(`\n      import React from 'react'\n      import { createScope, map, transformProxies } from '../helpers'\n      ${shouldHaveStyles ? `import \"${stylesDir}/${this.className}.css\"` : ''}\n      ==>${this[_].composeChildImports(compDir)}<==\n\n      let Controller\n\n      class ${this.className} extends React.Component {\n        static get Controller() {\n          if (Controller) return Controller\n\n          try {\n            Controller = require('${ctrlsDir}/${this.ctrlClassName}')\n            Controller = Controller.default || Controller\n\n            return Controller\n          }\n          catch (e) {\n            if (e.code == 'MODULE_NOT_FOUND') {\n              Controller = ${this.className}\n\n              return Controller\n            }\n\n            throw e\n          }\n        }\n\n        render() {\n          const proxies = Controller !== ${\n            this.className\n          } ? transformProxies(this.props.children) : {\n            ==>${this[_].composeProxiesDefault()}<==\n          }\n\n          let renderMeta\n          try {\n            renderMeta = require(\"${metaDir}/${this.metaClassName}\")\n            renderMeta = renderMeta.default || renderMeta\n          } catch (e) {\n            // pass\n            renderMeta = () => null;\n          }\n\n          return (\n            <span>\n              {renderMeta()}\n              ==>${this.jsx}<==\n            </span>\n          )\n        }\n      }\n\n      export default ${this.className}\n    `);\n  }\n\n  _composeStyleImports() {\n    // const hrefs = this[_].styles.map(({ type, body }) => {\n    //   return type == 'href' && body\n    // }).filter(Boolean)\n\n    const sheets = this[_].styles\n      .map(({ type, body }) => {\n        return type == \"sheet\" && body;\n      })\n      .filter(Boolean);\n\n    let css = \"\";\n\n    // css += hrefs.map((href) => {\n    //   return `@import url(${href});`\n    // }).join('\\n')\n\n    css += \"\\n\\n\";\n\n    css += sheets\n      .map(sheet => {\n        return sheet;\n      })\n      .join(\"\\n\\n\");\n\n    return escape(css.trim());\n  }\n\n  _composeProxiesDefault() {\n    return this[_].sockets\n      .map(socket => {\n        return `'${socket}': [],`;\n      })\n      .join(\"\\n\");\n  }\n\n  _composeChildImports(compDir) {\n    const imports = this[_].children.map(child => {\n      return `import ${child.className} from '${compDir}/${child.className}'`;\n    });\n\n    // Line skip\n    imports.push(\"\");\n\n    return imports.join(\"\\n\");\n  }\n\n  _composeScriptsDeclerations() {\n    return this[_].scripts\n      .map(script => {\n        if (script.type == \"src\") {\n          return `fetch(\"${script.body}\").then(body => body.text()),`;\n        }\n\n        const minified = uglify.minify(script.body).code;\n        // Unknown script format ??? fallback to maxified version\n        const code = minified || script.body;\n\n        return `Promise.resolve(\"${escape(code)}\"),`;\n      })\n      .join(\"\\n\");\n  }\n\n  _composeScriptsInvocations() {\n    if (!this[_].scripts) return \"\";\n\n    const invoke = freeScope(\"eval(arguments[0])\", \"window\", {\n      script: null\n    });\n\n    return freeText(`\n      scripts.concat(Promise.resolve()).reduce((loaded, loading) => {\n        return loaded.then((script) => {\n          ==>${invoke}<==\n\n          return loading\n        })\n      })\n    `);\n  }\n}\n\nfunction bindJSX(jsx, children = []) {\n  children.forEach(child => {\n    jsx = jsx.replace(\n      new RegExp(`af-${child.elName}`, \"g\"),\n      `${child.className}.Controller`\n    );\n  });\n\n  // ORDER MATTERS\n  return (\n    jsx\n      // Open close\n      .replace(\n        /<([\\w_-]+)-af-sock-([\\w_-]+)(.*?)>([^]*)<\\/\\1-af-sock-\\2>/g,\n        (match, el, sock, attrs, children) =>\n          // If there are nested sockets\n          /<[\\w_-]+-af-sock-[\\w_-]+/.test(children)\n            ? `{map(proxies['${sock}'], props => <${el} ${mergeProps(\n                attrs\n              )}>{createScope(props.children, proxies => <React.Fragment>${bindJSX(\n                children\n              )}</React.Fragment>)}</${el}>)}`\n            : `{map(proxies['${sock}'], props => <${el} ${mergeProps(\n                attrs\n              )}>{props.children ? props.children : <React.Fragment>${children}</React.Fragment>}</${el}>)}`\n      )\n      // Self closing\n      .replace(\n        /<([\\w_-]+)-af-sock-([\\w_-]+)(.*?) \\/>/g,\n        (match, el, sock, attrs) =>\n          `{map(proxies['${sock}'], props => <${el} ${mergeProps(\n            attrs\n          )}>{props.children}</${el}>)}`\n      )\n  );\n}\n\n// Merge props along with class name\nfunction mergeProps(attrs) {\n  attrs = attrs.trim();\n\n  if (!attrs) {\n    return \"{...props}\";\n  }\n\n  let className = attrs.match(/className=\"([^\"]+)\"/);\n\n  if (!className) {\n    return `${attrs} {...props}`;\n  }\n\n  className = className[1];\n  attrs = attrs.replace(/ ?className=\"[^\"]+\"/, \"\");\n\n  return `${attrs} {...{...props, className: \\`${className} $\\{props.className || ''}\\`}}`.trim();\n}\n\nexport default ViewWriter;\n","module.exports = require(\"htmltojsx\");","module.exports = require(\"statuses\");","module.exports = require(\"uglify-js\");","/* eslint-disable */\n\nexport default `const md5File = require('md5-file');\nconst path = require('path');\n\n// CSS styles will be imported on load and that complicates matters... ignore those bad boys!\nconst ignoreStyles = require('ignore-styles');\nconst register = ignoreStyles.default;\n\n// We also want to ignore all image requests\n// When running locally these will load from a standard import\n// When running on the server, we want to load via their hashed version in the build folder\nconst extensions = ['.gif', '.jpeg', '.jpg', '.png', '.svg'];\n\n// Override the default style ignorer, also modifying all image requests\nregister(ignoreStyles.DEFAULT_EXTENSIONS, (mod, filename) => {\n  if (!extensions.find(f => filename.endsWith(f))) {\n    // If we find a style\n    return ignoreStyles.noOp();\n  } else {\n    // If we find an image\n    const hash = md5File.sync(filename).slice(0, 8);\n    const bn = path.basename(filename).replace(/(\\.\\w{3})$/, '.'+hash+'$1');\n\n    mod.exports = '/static/media/'+bn;\n  }\n});\n\n// Set up babel to do its thing... env for the latest toys, react-app for CRA\n// Notice three plugins: the first two allow us to use import rather than require, the third is for code splitting\n// Polyfill is required for Babel 7, polyfill includes a custom regenerator runtime and core-js\nrequire('@babel/polyfill');\nrequire('@babel/register')({\n  ignore: [/\\\\/(build|node_modules)\\\\//],\n  presets: ['@babel/preset-env', '@babel/preset-react'],\n  plugins: [\n    '@babel/plugin-syntax-dynamic-import',\n    '@babel/plugin-proposal-class-properties',\n    'dynamic-import-node',\n    'react-loadable/babel'\n  ]\n});\n\n// Now that the nonsense is over... load up the server entry point\nrequire('./server');\n`\n\n/* eslint-enable */","/* eslint-disable */\n\nexport default `// Express requirements\nimport path from 'path';\nimport fs from 'fs';\n\n// React requirements\nimport React from 'react';\nimport { renderToString } from 'react-dom/server';\nimport Helmet from 'react-helmet';\nimport { StaticRouter } from 'react-router';\nimport { Frontload, frontloadServerRender } from 'react-frontload';\nimport Loadable from 'react-loadable';\n\nimport App from '../src/App';\nimport manifest from '../build/manifest.json';\n\n// LOADER\nexport default (req, res) => {\n  /*\n    A simple helper function to prepare the HTML markup. This loads:\n      - Page title\n      - SEO meta tags\n      - Preloaded state (for Redux) depending on the current route\n      - Code-split script tags depending on the current route\n  */\n  const injectHTML = (data, { html, title, meta, body, scripts, state }) => {\n    data = data.replace('<html>', '<html '+ html + '>');\n    data = data.replace(/<title>.*?<\\\\/title>/g, title);\n    data = data.replace('</head>', meta +\n        '<link rel=\"stylesheet\" href=\"/css/amli.webflow.css\" />' +\n        '<link rel=\"stylesheet\" href=\"/css/webflow.css\" />' +\n        '<link rel=\"stylesheet\" href=\"/css/normalize.css\" />' +\n    '</head>');\n    data = data.replace(\n      '<div id=\"root\"></div>',\n      '<div id=\"root\">'+body+'</div><script>window.__PRELOADED_STATE__ = '+state+'</script>'\n    );\n    data = data.replace('</body>', scripts.join('') + '</body>');\n\n    return data;\n  };\n\n  // Load in our HTML file from our build\n  fs.readFile(\n    path.resolve(__dirname, '../build/index.html'),\n    'utf8',\n    (err, htmlData) => {\n      // If there's an error... serve up something nasty\n      if (err) {\n        console.error('Read error', err);\n\n        return res.status(404).end();\n      }\n\n      const context = {};\n      const modules = [];\n\n      /*\n        Here's the core funtionality of this file. We do the following in specific order (inside-out):\n          1. Load the <App /> component\n          2. Inside of the Frontload HOC\n          3. Inside of a Redux <StaticRouter /> (since we're on the server), given a location and context to write to\n          4. Inside of the store provider\n          5. Inside of the React Loadable HOC to make sure we have the right scripts depending on page\n          6. Render all of this sexiness\n          7. Make sure that when rendering Frontload knows to get all the appropriate preloaded requests\n\n        In English, we basically need to know what page we're dealing with, and then load all the appropriate scripts and\n        data for that page. We take all that information and compute the appropriate state to send to the user. This is\n        then loaded into the correct components and sent as a Promise to be handled below.\n      */\n      frontloadServerRender(() =>\n        renderToString(\n              <StaticRouter location={req.url} context={context}>\n                <Frontload isServer={true}>\n                  <App />\n                </Frontload>\n              </StaticRouter>\n        )\n      ).then(routeMarkup => {\n        if (context.url) {\n\n          res.writeHead(302, {\n            Location: context.url\n          });\n\n          res.end();\n        } else {\n          // Otherwise, we carry on...\n\n          // Let's give ourself a function to load all our page-specific JS assets for code splitting\n          const extractAssets = (assets, chunks) =>\n            Object.keys(assets)\n              .filter(asset => chunks.indexOf(asset.replace('.js', '')) > -1)\n              .map(k => assets[k]);\n\n          // Let's format those assets into pretty <script> tags\n          const extraChunks = extractAssets(manifest, modules).map(\n            c => '<script type=\"text/javascript\" src=\"/'+c.replace(/^\\\\//, '')+'\"></script>'\n          );\n\n          // We need to tell Helmet to compute the right meta tags, title, and such\n          const helmet = Helmet.renderStatic();\n\n          // NOTE: Disable if you desire\n          // Let's output the title, just to see SSR is working as intended\n          console.log('THE TITLE ------- >', helmet.title.toString());\n\n          // Pass all this nonsense into our HTML formatting function above\n          const html = injectHTML(htmlData, {\n            html: helmet.htmlAttributes.toString(),\n            title: helmet.title.toString(),\n            meta: helmet.meta.toString(),\n            body: routeMarkup,\n            scripts: extraChunks,\n          });\n\n          // We have all the final HTML, let's send it to the user already!\n          res.send(html);\n        }\n      });\n    }\n  );\n};\n`\n\n/* eslint-enable */","/* eslint-disable */\n\nexport default `// Express requirements\nimport bodyParser from 'body-parser';\nimport compression from 'compression';\nimport express from 'express';\nimport morgan from 'morgan';\nimport path from 'path';\n// import forceDomain from 'forcedomain';\nimport Loadable from 'react-loadable';\nimport cookieParser from 'cookie-parser';\n\n// Our loader - this basically acts as the entry point for each page load\nimport loader from './loader';\n\n// Create our express app using the port optionally specified\nconst app = express();\nconst PORT = process.env.PORT || 3000;\n\n// NOTE: UNCOMMENT THIS IF YOU WANT THIS FUNCTIONALITY\n/*\n  Forcing www and https redirects in production, totally optional.\n\n  http://mydomain.com\n  http://www.mydomain.com\n  https://mydomain.com\n\n  Resolve to: https://www.mydomain.com\n*/\n// if (process.env.NODE_ENV === 'production') {\n//   app.use(\n//     forceDomain({\n//       hostname: 'www.mydomain.com',\n//       protocol: 'https'\n//     })\n//   );\n// }\n\n// Compress, parse, log, and raid the cookie jar\napp.use(compression());\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: false }));\napp.use(morgan('dev'));\napp.use(cookieParser());\n\n// Set up homepage, static assets, and capture everything else\napp.use(express.Router().get('/', loader));\napp.use(express.static(path.resolve(__dirname, '../build')));\napp.use(loader);\n\n// We tell React Loadable to load all required assets and start listening - ROCK AND ROLL!\nLoadable.preloadAll().then(() => {\n  app.listen(PORT, console.log('App listening on port' + PORT + '!'));\n});\n\n// Handle the bugs somehow\napp.on('error', error => {\n  if (error.syscall !== 'listen') {\n    throw error;\n  }\n\n  const bind = typeof PORT === 'string' ? 'Pipe ' + PORT : 'Port ' + PORT;\n\n  switch (error.code) {\n    case 'EACCES':\n      console.error(bind + ' requires elevated privileges');\n      process.exit(1);\n      break;\n    case 'EADDRINUSE':\n      console.error(bind + ' is already in use');\n      process.exit(1);\n      break;\n    default:\n      throw error;\n  }\n});`\n\n/* eslint-enable */","import path from 'path'\nimport { requireText } from '../utils'\n\nconst resolve = filename => path.resolve(__dirname, '../src/raw', filename)\n\n// Exporting an object since we're dealing with a getter\nexport default {\n  get viewHelpers() {\n    return requireText(resolve('viewHelpers.js'))\n  }\n}\n","import fetch from 'node-fetch'\nimport path from 'path'\nimport uglify from 'uglify-js'\nimport { fs, mkdirp } from '../libs'\nimport Writer from './writer'\n\nimport {\n  Internal,\n  escape,\n  freeText,\n  freeLint,\n  freeContext,\n  padLeft,\n  requireText,\n} from '../utils'\n\nconst _ = Symbol('_ScriptWriter')\n\n@Internal(_)\nclass ScriptWriter extends Writer {\n  get scripts() {\n    return this[_].scripts.slice()\n  }\n\n  get prefetch() {\n    return this[_].prefetch\n  }\n\n  set prefetch(prefetch) {\n    return this[_].prefetch = !!prefetch\n  }\n\n  get baseUrl() {\n    return this[_].baseUrl\n  }\n\n  set baseUrl(baseUrl) {\n    this[_].baseUrl = String(baseUrl)\n  }\n\n  constructor(options = {}) {\n    super()\n\n    this[_].scripts = []\n\n    this.baseUrl = options.baseUrl\n    this.prefetch = options.prefetch\n  }\n\n  async write(dir, options) {\n    await mkdirp(dir)\n\n    options = {\n      ...options,\n      prefetch: this.prefetch,\n    }\n\n    const indexFilePath = `${dir}/index.js`\n    const childFilePaths = [indexFilePath]\n\n    if (!options.prefetch) {\n      await fs.writeFile(indexFilePath, this[_].composeScriptLoader())\n      return childFilePaths\n    }\n\n    const scriptFileNames = this.scripts.map((script, index, { length }) => {\n      const fileName = padLeft(index, length / 10 + 1, 0) + '.js'\n      const filePath = `${dir}/${fileName}`\n      childFilePaths.push(filePath)\n\n      return fileName\n    })\n\n    const fetchingScripts = this.scripts.map(async (script, index) => {\n      const scriptFileName = scriptFileNames[index]\n\n      let code = script.type == 'code'\n        ? script.body\n        : /^http/.test(script.body)\n        ? await fetch(script.body)\n          .then(res => res.text())\n          .then(text => uglify.minify(text).code)\n        : requireText(`${this.baseUrl}/${script.body}`)\n      code = code.replace(/\\n\\/\\/# ?sourceMappingURL=.*\\s*$/, '')\n      code = freeContext(code)\n\n      return fs.writeFile(`${dir}/${scriptFileName}`, code)\n    })\n\n    const scriptsIndexContent = scriptFileNames.map((scriptFileName) => {\n      return `import './${scriptFileName}'`\n    }).join('\\n')\n\n    const writingIndex = fs.writeFile(\n      indexFilePath,\n      freeLint(scriptsIndexContent),\n    )\n\n    await Promise.all([\n      ...fetchingScripts,\n      writingIndex,\n    ])\n\n    return childFilePaths\n  }\n\n  setScript(src, content) {\n    let type\n    let body\n\n    if (src) {\n      type = 'src'\n      body = /^\\w+:\\/\\//.test(src) ? src : path.resolve('/', src)\n    }\n    else {\n      type = 'code'\n      body = uglify.minify(content).code\n    }\n\n    const exists = this[_].scripts.some((script) => {\n      return script.body == body\n    })\n\n    if (!exists) {\n      this[_].scripts.push({ type, body })\n    }\n  }\n\n  _composeScriptLoader() {\n    const scripts = this[_].scripts.map((script) => {\n      return freeText(`\n        {\n          type: '${script.type}',\n          body: '${escape(script.body, \"'\")}',\n        },\n      `)\n    }).join('\\n')\n\n    return freeLint(`\n      const scripts = [\n        ==>${scripts}<==\n      ]\n\n      const loadingScripts = scripts.reduce((loaded, script) => loaded.then(() => {\n        const scriptEl = document.createElement('script')\n        scriptEl.type = 'text/javascript'\n        let loading\n\n        if (script.type == 'src') {\n          scriptEl.src = script.body\n\n          loading = new Promise((resolve, reject) => {\n            scriptEl.onload = resolve\n            scriptEl.onerror = reject\n          })\n        }\n        else {\n          scriptEl.innerHTML = script.body\n\n          loading = Promise.resolve()\n        }\n\n        document.head.appendChild(scriptEl)\n\n        return loading\n      }), Promise.resolve())\n\n      export default loadingScripts\n    `)\n  }\n}\n\nexport default ScriptWriter\n","module.exports = require(\"node-fetch\");","import CleanCSS from 'clean-css'\nimport fetch from 'node-fetch'\nimport path from 'path'\nimport { fs, mkdirp } from '../libs'\nimport { encapsulateCSS } from '../utils'\nimport Writer from './writer'\n\nimport {\n  Internal,\n  escape,\n  freeText,\n  freeLint,\n  padLeft,\n  requireText,\n} from '../utils'\n\nconst _ = Symbol('_StyleWriter')\nconst cleanCSS = new CleanCSS({\n  rebaseTo: '..'\n})\n\n@Internal(_)\nclass StyleWriter extends Writer {\n  get styles() {\n    return this[_].styles.slice()\n  }\n\n  get prefetch() {\n    return this[_].prefetch\n  }\n\n  set prefetch(prefetch) {\n    return this[_].prefetch = !!prefetch\n  }\n\n  get baseUrl() {\n    return this[_].baseUrl\n  }\n\n  set baseUrl(baseUrl) {\n    this[_].baseUrl = String(baseUrl)\n  }\n\n  get source() {\n    return this[_].source\n  }\n\n  set source(source) {\n    this[_].source = String(source)\n  }\n\n  constructor(options = {}) {\n    super()\n\n    this[_].styles = []\n\n    this.baseUrl = options.baseUrl\n    this.prefetch = options.prefetch\n    this.source = options.srouce\n  }\n\n  async write(dir, options) {\n    await mkdirp(dir)\n\n    options = {\n      ...options,\n      prefetch: this.prefetch,\n    }\n\n    const indexFilePath = `${dir}/index.js`\n    const childFilePaths = [indexFilePath]\n\n    if (!options.prefetch) {\n      await fs.writeFile(indexFilePath, this[_].composeStyleLoader())\n      return childFilePaths\n    }\n\n    const styleFileNames = this.styles.map((style, index, { length }) => {\n      const fileName = padLeft(index, length / 10 + 1, 0) + '.css'\n      const filePath = `${dir}/${fileName}`\n      childFilePaths.push(filePath)\n\n      return fileName\n    })\n\n    const fetchingStyles = this.styles.map(async (style, index) => {\n      const styleFileName = styleFileNames[index]\n\n      const sheet = style.type == 'sheet'\n        ? style.body\n        : /^http/.test(style.body)\n        ? await fetch(style.body).then(res => res.text())\n        : await requireText.promise(`${this.baseUrl}/${style.body}`)\n\n      return fs.writeFile(`${dir}/${styleFileName}`, this[_].transformSheet(sheet))\n    })\n\n    const stylesIndexContent = styleFileNames.map((styleFileName) => {\n      return `import './${styleFileName}'`\n    }).join('\\n')\n\n    const writingIndex = fs.writeFile(\n      indexFilePath,\n      freeLint(stylesIndexContent),\n    )\n\n    await Promise.all([\n      ...fetchingStyles,\n      writingIndex,\n    ])\n\n    return childFilePaths\n  }\n\n  setStyle(href, content) {\n    let type\n    let body\n\n    if (href) {\n      type = 'href'\n      body = /^\\w+:\\/\\//.test(href) ? href : path.resolve('/', href)\n    }\n    else {\n      type = 'sheet'\n      body = content\n    }\n\n    const exists = this[_].styles.some((style) => {\n      return style.body == body\n    })\n\n    if (!exists) {\n      this[_].styles.push({ type, body })\n    }\n  }\n\n  _composeStyleLoader() {\n    this[_].styles.forEach((style) => {\n      if (style.type == 'sheet') {\n        style.body = this[_].transformSheet(style.body)\n      }\n    })\n\n    const styles = this[_].styles.map((style) => {\n      return freeText(`\n        {\n          type: '${style.type}',\n          body: '${escape(style.body, \"'\")}',\n        },\n      `)\n    }).join('\\n')\n\n    return freeLint(`\n      const styles = [\n        ==>${styles}<==\n      ]\n\n      const loadingStyles = styles.map((style) => {\n        let styleEl\n        let loading\n\n        if (style.type == 'href') {\n          styleEl = document.createElement('link')\n\n          loading = new Promise((resolve, reject) => {\n            styleEl.onload = resolve\n            styleEl.onerror = reject\n          })\n\n          styleEl.rel = 'stylesheet'\n          styleEl.type = 'text/css'\n          styleEl.href = style.body\n        }\n        else {\n          styleEl = document.createElement('style')\n          styleEl.type = 'text/css'\n          styleEl.innerHTML = style.body\n\n          loading = Promise.resolve()\n        }\n\n        document.head.appendChild(styleEl)\n\n        return loading\n      })\n\n      export default Promise.all(loadingStyles).then(() => {\n        const styleSheets = Array.from(document.styleSheets).filter((styleSheet) => {\n          return styleSheet.href && styles.some((style) => {\n            return style.type == 'href' && styleSheet.href.match(style.body)\n          })\n        })\n        styleSheets.forEach((styleSheet) => {\n          Array.from(styleSheet.rules).forEach((rule) => {\n            if (rule.selectorText) {\n              rule.selectorText = rule.selectorText\n                .replace(/\\\\.([\\\\w_-]+)/g, '.af-class-$1')\n                .replace(/\\\\[class(.?)=\"( ?)([^\"]+)( ?)\"\\\\]/g, '[class$1=\"$2af-class-$3$4\"]')\n                .replace(/([^\\\\s][^,]*)(\\\\s*,?)/g, '.af-view $1$2')\n                .replace(/\\\\.af-view html/g, '.af-view')\n                .replace(/\\\\.af-view body/g, '.af-view')\n                ==>${this[_].composeSourceReplacements()}<==\n            }\n          })\n        })\n      })\n    `)\n  }\n\n  _composeSourceReplacements() {\n    switch (this.source) {\n      case 'webflow':\n        return freeText(`\n          .replace(/af-class-w-/g, 'w-')\n        `)\n      case 'sketch':\n        return freeText(`\n          .replace(/af-class-anima-/g, 'anima-')\n          .replace(/af-class-([\\\\w_-]+)an-animation([\\\\w_-]+)/g, '$1an-animation$2')\n        `)\n      default:\n        return freeText(`\n          .replace(/af-class-w-/g, 'w-')\n          .replace(/af-class-anima-/g, 'anima-')\n          .replace(/af-class-([\\\\w_-]+)an-animation([\\\\w_-]+)/g, '$1an-animation$2')\n        `)\n    }\n  }\n\n  // Will minify and encapsulate classes\n  _transformSheet(sheet) {\n    sheet = encapsulateCSS(sheet, this.source)\n    sheet = cleanCSS.minify(sheet).styles\n\n    // Make URLs absolute so webpack won't throw any errors\n    return sheet.replace(/url\\(([^)]+)\\)/g, (match, url) => {\n      if (/^(.+):\\/\\//.test(url)) return match\n\n      url = path.resolve('/', url)\n      return `url(${url})`\n    })\n  }\n}\n\nexport default StyleWriter\n","module.exports = require(\"clean-css\");"],"sourceRoot":""}